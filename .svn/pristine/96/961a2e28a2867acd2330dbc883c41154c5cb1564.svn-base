<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<!-- style.css -->
<style>
	/* 여기 스타일 전부 가져다가 복붙하셔야해요  
	본인이 만든 페이지 내용 제일 바깥쪽에 div하나 만들고 "counsel_box" 이런식으로 특별한?클래스이름을 붙여주세요*/
	.counsel_box{width:100%; padding:40px; background-color:#ffffff;}
	/* 상단에 있는 제목 (여기서는 상담내역) css입니다
	 그대로 복붙하시고 해당div에  .table_topic값 주세요*/
	.counsel_box .table_topic{font-size: 20px; padding-bottom:30px;}
	.counsel_box .table_topic i{margin-left:10px;}
	/* table입니다 */
	.counsel_box table{font-size:14px; width:100%; text-align:center;}
	/* 테이블의 시작부분 타이틀입니다 */
	.table_title{font-size:13px; border-top:1px solid #333333!important; border-bottom:1px solid #333333!important; height:32px; line-height:32px;}
	
	/* /////////////////여기가 수정시작!!  */
	.counsel_box tr{height:40px; border-bottom:1px solid #ebebeb;}
	.counsel_box tr:first-child{background-color:#EEF1F6;}
	.counsel_box tr:hover{background-color:#f2f3f4;}
	.counsel_box tr:first-child:hover{background-color:#EEF1F6;}
	/* /////////////////여기가 수정끝!!  */
	
	/* 각자 만든 td개수만큼만쓰고 총 합이 100이 되도록 잘 분배해서 쓰세요 이부분 제일 신경써서 해주세요*/
	.counsel_box tr td:nth-child(1){width:5%;}
	.counsel_box tr td:nth-child(2){width:10%;}
	.counsel_box tr td:nth-child(3){width:20%;}
	.counsel_box tr td:nth-child(4){width:10%;}
	.counsel_box tr td:nth-child(5){width:15%;}
	.counsel_box tr td:nth-child(6){width:15%;}
	.counsel_box tr td:nth-child(7){width:25%;}
</style>
<div class="counsel_box">
	<!-- 카테고리 표시 : 이거는 안에 스타일값 다 들어있으니까 통째로 복사하고 안에내용만 하드코딩하시면됩니다요 -->
	<div style="font-size:12px; color:#888888; margin-bottom: 20px;">
	<span><svg xmlns="http://www.w3.org/2000/svg" height="13" width="13" viewBox="0 0 576 512" style="margin-right: 5px;"><path fill="#888888" d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"/></svg></span>
	<span style="font-size:12px; color:#888888;">></span>
	<span style="font-size:12px; color:#888888;">상담</span>
	<span style="font-size:12px; color:#888888;">></span>
	<span style="font-size:12px; color:#888888;">상담내역</span>
	</div>
	<div class="table_topic">상담내역<i class="fa-solid fa-circle-info" style="color: #333333;"></i></div>
	<table>
		<tr class="table_title">
			<td>no</td>
			<td>상담종류</td>
			<td>상담신청일</td>
			<td>교수명</td>
			<td>승인여부</td>
			<!-- 상담날짜 이후에 써짐 -->
			<td>상담내역</td>
			<td>비고</td>
		</tr>
		<c:forEach var="counselVO" items="${data}" varStatus="stat">
		<tr>
			<td>${stat.count}</td>
			<td>${counselVO.commonDetailVO.comdNm}</td>
			<td>${counselVO.cnslDt}</td>
			<td>${counselVO.professorVO.userVO.userNm}</td>
			<td id="appYn">
				<c:choose>
					<c:when test="${counselVO.approvalVO.appYn eq 0}"><p class="btn-two mini green">대기</p></c:when>
					<c:when test="${counselVO.approvalVO.appYn eq 1}"><p class="btn-two mini sky">승인</p></c:when>
					<c:when test="${counselVO.approvalVO.appYn eq 2}"><p class="btn-two mini orange">반려</p></c:when>
				</c:choose>
			</td>
			<td><button class="btn-two gray mini">상담내용상세</button></td>
			<td>
			<%-- onclick="location.href='/student/counsel/counseldetail?cnslCd=${counselVO.cnslCd}'" --%>
			<%-- <c:if test="${counselVO.approvalVO.appYn != 0}">disabled</c:if> --%>
				<button class="btn-two dark mini modify-btn" data-app-yn="${counselVO.approvalVO.appYn}" onclick="location.href ='/student/counsel/counseldetail?cnslCd=${counselVO.cnslCd}'">상담수정</button>
				<button class="btn-two dark mini cancle-btn" data-app-yn="${counselVO.approvalVO.appYn}" data-cnsl-cd="${counselVO.cnslCd}">상담취소</button>
			</td>
		</tr>
		</c:forEach>
		
	</table>
</div>
<script>

$(".modify-btn").each(function() {
	const appYn= $(this).data("appYn");
/* 	const cnslCd=$(this).data("cnslCd"); */
	console.log(appYn,typeof appYn);
/* 	console.log(cnslCd); */
	if (appYn > 0) {
	    $(this).hide();
	}else{
	}
	
})
$(".cancle-btn").each(function() {
	const appYn= $(this).data("appYn");
	const cnslCd= $(this).data("cnslCd");
	console.log(cnslCd);
	if (appYn > 0) {
	    $(this).hide();
	}else{
		$(this).on("click", function() {
			Swal.fire({
			      /* title: '상담을 취소하시겠습니까?', */
			      /* toast: true, */
			      text: "상담을 취소하시겠습니까?",
			      icon: 'question',
			      /* warning,error,success,info,question */
			      width: 400,
			      /* padding: "4em", */
			      position:'top',
			      showCancelButton: true,
			      confirmButtonColor: '#3085d6',
			      cancelButtonColor: '#d33',
			      confirmButtonText: '상담취소',
			      cancelButtonText:  '뒤로가기',
			      /* reverseButtons: true, */ // 버튼 순서 거꾸로
			      
			    }).then((result) => {
			    	console.log(result);
			    	if (result.isConfirmed) {
		                var PageUrl = "/student/counsel/counselDelete?cnslCd="+cnslCd; 
		                window.location.href = PageUrl;
		            } else {
		                console.log("이동이 취소되었습니다.");
		            }
			    })
            
        });
	}
	
})

//     Swal.fire({
//       title: '정말로 그렇게 하시겠습니까?',
//       text: "다시 되돌릴 수 없습니다. 신중하세요.",
//       icon: 'warning',
//       showCancelButton: true,
//       confirmButtonColor: '#3085d6',
//       cancelButtonColor: '#d33',
//       confirmButtonText: '승인',
//       cancelButtonText: '취소',
//       reverseButtons: true, // 버튼 순서 거꾸로
      
//     }).then((result) => {
//       if (result.isConfirmed) {
//         Swal.fire(
//           '승인이 완료되었습니다.',
//           '화끈하시네요~!',
//           'success'
//         )
//       }
//     })

// var Toast = Swal.mixin({
// 		      toast: true,
// 		      position: 'top-end',
// 		      showConfirmButton: false,
// 		      timer: 3000
// 		    });
		
// 		Toast.fire({
// 			icon:'success',
// 			title:'개똥이'
// 		}); 
</script>






